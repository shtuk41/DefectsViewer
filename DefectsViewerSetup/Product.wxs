<?xml version="1.0" encoding="UTF-8"?>
<Wix xmlns="http://schemas.microsoft.com/wix/2006/wi">
	<Product Id="*" Name="DefectsViewerSetup" Language="1033" Version="1.0.0.0" Manufacturer="Carl Zeiss AG" UpgradeCode="d896f7a5-cb22-4b21-9ca2-e8a6a1505cec">
		<Package InstallerVersion="200" Compressed="yes" InstallScope="perMachine" />
    <Media Id="1" Cabinet="DefectsViewer.cab" EmbedCab="yes" />
		<MajorUpgrade DowngradeErrorMessage="A newer version of [ProductName] is already installed." />
		<Feature Id="ProductFeature" Title="DefectsViewerSetup" Level="1">
			<ComponentGroupRef Id="ProductComponents" />
      <ComponentRef Id="ModelsFolderComponent" />
      <ComponentRef Id="ImagesFolderComponent" />
		</Feature>
    <UIRef Id="WixUI_Minimal"/>
    <WixVariable Id="WixUILicenseRtf" Value="LicenseAgreement.rtf" />
	</Product>

	<Fragment>
		<Directory Id="TARGETDIR" Name="SourceDir">
      <Directory Id="DesktopFolder" Name="Desktop"/>
      <Directory Id="ProgramMenuFolder" Name="Programs">
        <Directory Id="ProgramMenuDir" Name="DefectsViewer"/>
      </Directory>
      <Directory Id="ProgramFilesFolder">
        <Directory Id="INSTALLFOLDER" Name="DefectsViewer">
          <Directory Id="ModelsId" Name="models">
            <Component Id="ModelsFolderComponent" Guid="23b5de91-c211-4f9d-a6fa-394a6fde6d97">
              <CreateFolder Directory="ModelsId">
                <Permission User="Everyone" GenericAll="yes"/>
              </CreateFolder>
            </Component>
          </Directory>
          <Directory Id="ImagesId" Name="images">
            <Component Id="ImagesFolderComponent" Guid="42f76628-43af-4292-b07e-1aa42ad977ca">
              <CreateFolder Directory="ImagesId">
                <Permission User="Everyone" GenericAll="yes"/>
              </CreateFolder>
            </Component>
          </Directory>
        </Directory>
      </Directory>
    </Directory>
	</Fragment>

	<Fragment>
    <Icon Id="DefectsViewer.ico" SourceFile="..\Shaders\DefectsViewer.ico"/>
		<ComponentGroup Id="ProductComponents">
      <Component Id="Models" Guid="79e6d328-d3ad-4f0b-9eb2-870229c5c9a5" Directory="ModelsId">
        <File Id="Customerstl" Name="customer.stl" DiskId="1" Source="..\Shaders\models\customer.stl"/>
        <File Id="Pointer1" Name="pointer1.stl" DiskId="1" Source="..\Shaders\models\pointer1.stl"/>
        <File Id="Pointer2" Name="pointer2.stl" DiskId="1" Source="..\Shaders\models\pointer2.stl"/>
      </Component>
      <Component Id="Images" Guid="20775e98-b02b-4337-a9d5-9219f6a344d4" Directory="ImagesId">
        <File Id="Legends" Name="DefectViewerLegends.bmp" DiskId="1" Source="..\Shaders\images\DefectViewerLegends.bmp"/>
      </Component>
      <Component Id="DefectsViewerExecutable" Guid="47c23c72-d27d-407d-876a-8426fb4c4684" Directory="INSTALLFOLDER">
        <File Id="DefectsViewerExe" Name="DefectsViewer.exe" DiskId="1" Source="..\Release\DefectsViewer.exe" KeyPath="yes">
          <Shortcut Id="startmenuDefectsViewer" Directory="ProgramMenuDir" Name="Defects Viewer"
           WorkingDirectory="INSTALLFOLDER" IconIndex="0" Advertise="yes" Icon="DefectsViewer.ico"/>
          <Shortcut Id="desktopDefectViewer" Directory="DesktopFolder" Name="DefectViewer"
                    WorkingDirectory="INSTALLFOLDER" IconIndex="0" Advertise="yes"  Icon="DefectsViewer.ico"/>
        </File>
        <File Id="Shaderfrag" Name="shader.frag" DiskId="1" Source="..\Shaders\shader.frag"/>
        <File Id="Shadervert" Name="shader.vert" DiskId="1" Source="..\Shaders\shader.vert"/>
         <File Id="DevIL" Name="DevIL.dll" DiskId="1" Source="..\Shaders\DevIL.dll"/>
        <File Id="Options" Name="options.xml" DiskId="1" Source="..\Shaders\options.xml"/>
      </Component>
      <Component Id="ProgramMenuDir" Guid="ac87cecc-3489-4d86-9794-9346d438b3bb" Directory="INSTALLFOLDER">
        <RemoveFolder Id='ProgramMenuDir' On='uninstall'/>
        <RegistryValue Root='HKCU' Key='Software\[Manufacturer]\[ProductName]' Name='installed' Type='integer' Value='1' KeyPath='yes' />
        <RemoveFolder Id='RemoveProgramMenuDir' Directory='ProgramMenuDir' On='uninstall'/>
      </Component>
    </ComponentGroup>
  </Fragment>
</Wix>